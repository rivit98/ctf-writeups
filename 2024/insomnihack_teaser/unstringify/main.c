
#include "rivit_common.h"

/*
aesdec
STATE := SRC1;
RoundKey := SRC2;
STATE := InvShiftRows( STATE );
STATE := InvSubBytes( STATE );
STATE := InvMixColumns( STATE );
DEST[127:0] := STATE XOR RoundKey;
DEST[MAXVL-1:128] (Unmodified)
*/
void aesdec(state_t* state_ptr, const uint8_t* RoundKey) {
    AddRoundKey(0, state_ptr, RoundKey);
    InvMixColumns(state_ptr);
    InvSubBytes(state_ptr);
    InvShiftRows(state_ptr);
}

/*
aesenc
STATE := SRC1;
RoundKey := SRC2;
STATE := ShiftRows( STATE );
STATE := SubBytes( STATE );
STATE := MixColumns( STATE );
DEST[127:0] := STATE XOR RoundKey;
DEST[MAXVL-1:128] (Unmodified)
*/

int main() {
    uint8_t key[32] = {0x0, 0x3, 0x19, 0x5a, 0x5b, 0x0, 0x59, 0x2, 0x0, 0x3, 0x15, 0x1, 0x5c, 0x9, 0x1, 0x5e, 0x42, 0x53, 0xd, 0x16, 0x4d, 0x6, 0x42, 0xd, 0x27, 0x52, 0x42, 0x3a, 0x63, 0xb, 0x54, 0xf};

    uint8_t enc[32] = {
      0x51,0xCC,0x0F,0xBE,0xA0,0x26,0x2A,0x14,0x6D,0x75,0x89,0x30,0xEC,0xFD,0x46,0x1C,0x0F,0xA3,0xB4,0x79,0x8B,0x62,0xC9,0x06,0x68,0xEA,0x03,0xBE,0x2A,0xC7,0xF2,0xC4
    };

    aesdec(enc, key);
    aesdec(enc+16, key+16);

    hexdump(enc, 32);
    printf("%.8s%.8s%.8s%.8s\n", &enc[24], &enc[16], &enc[8], &enc[0]);
}
