/* This file was generated by the Hex-Rays decompiler version 7.7.0.220118.
   Copyright (c) 2007-2021 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall sub_0(); // weak
__int64 __fastcall sub_42F(__int64 a1, _BYTE *a2);
_WORD *__fastcall sub_53A(_WORD *a1, _WORD *a2);
__int64 __fastcall sub_5BD(_BYTE *a1, _BYTE *a2);
__int64 __fastcall sub_60F(_WORD *a1);
__int64 __fastcall sub_6A9(__int64 a1, __int64 a2);
_BOOL8 __fastcall sub_7AA(_BYTE *wallet);


//----- (0000000000000000) ----------------------------------------------------
__int64 sub_0()
{
  __int64 *v0; // rax
  __int64 *v1; // rax
  __int64 *v2; // rax
  __int64 v4[126]; // [rsp+20h] [rbp-60h] BYREF
  __int64 v5[126]; // [rsp+410h] [rbp+390h] BYREF
  char v6[16]; // [rsp+800h] [rbp+780h] BYREF
  char v7[24]; // [rsp+816h] [rbp+796h] BYREF
  char v8[22]; // [rsp+82Eh] [rbp+7AEh] BYREF
  char v9[12]; // [rsp+844h] [rbp+7C4h] BYREF
  _QWORD v10[2]; // [rsp+850h] [rbp+7D0h] BYREF
  __int16 v11; // [rsp+860h] [rbp+7E0h]
  char v12[14]; // [rsp+862h] [rbp+7E2h] BYREF
  char v13[48]; // [rsp+870h] [rbp+7F0h] BYREF
  char v14[48]; // [rsp+8A0h] [rbp+820h] BYREF
  char v15[48]; // [rsp+8D0h] [rbp+850h] BYREF
  __int64 (__fastcall *v16)(_QWORD, __int64 *, char *, _QWORD); // [rsp+900h] [rbp+880h]
  __int64 v17; // [rsp+908h] [rbp+888h]
  __int64 (__fastcall *v18)(char *); // [rsp+910h] [rbp+890h]
  void (__fastcall *v19)(__int64); // [rsp+918h] [rbp+898h]
  __int64 v20; // [rsp+920h] [rbp+8A0h]
  __int64 *v21; // [rsp+928h] [rbp+8A8h]

  strcpy(v15, "C:\\Users\\Public\\Documents\\token.txt");
  strcpy(v14, "C:\\Users\\Public\\Documents\\credentials.txt");
  strcpy(v13, "C:\\Users\\Public\\Documents\\wallet.txt");
  *(_QWORD *)v12 = 0x72006500730075i64;
  *(_QWORD *)&v12[6] = 0x3200330072i64;
  v10[0] = 0x6E00720065006Bi64;
  v10[1] = 0x320033006C0065i64;
  v11 = 0;
  strcpy(v9, "CreateFileA");
  strcpy(&v8[9], "LoadLibraryW");
  strcpy(v8, "ReadFile");
  strcpy(&v7[12], "ExitProcess");
  strcpy(v7, "MessageBoxA");
  strcpy(v6, "Congratulations");
  v20 = sub_60F(v10);
  v19 = (void (__fastcall *)(__int64))sub_42F(v20, (__int64)&v7[12]);
  v18 = (__int64 (__fastcall *)(char *))sub_42F(v20, (__int64)&v8[9]);
  v17 = v18(v12);
  v16 = (__int64 (__fastcall *)(_QWORD, __int64 *, char *, _QWORD))sub_42F(v17, (__int64)v7);
  memset(v5, 0, 1000);
  sub_6A9((__int64)v13, (__int64)v5);
  if ( !sub_7AA((__int64)v5) )
    v19(1i64);
  v4[0] = 0x7B333263736365i64;
  memset(&v4[1], 0, 992);
  v21 = v4;
  do
    v21 = (__int64 *)((char *)v21 + 1);
  while ( *(_BYTE *)v21 );
  sub_6A9((__int64)v15, (__int64)v21);
  do
    v21 = (__int64 *)((char *)v21 + 1);
  while ( *(_BYTE *)v21 );
  v0 = v21;
  v21 = (__int64 *)((char *)v21 + 1);
  *(_BYTE *)v0 = 45;
  sub_6A9((__int64)v14, (__int64)v21);
  do
    v21 = (__int64 *)((char *)v21 + 1);
  while ( *(_BYTE *)v21 );
  v1 = v21;
  v21 = (__int64 *)((char *)v21 + 1);
  *(_BYTE *)v1 = 45;
  sub_6A9((__int64)v13, (__int64)v21);
  do
    v21 = (__int64 *)((char *)v21 + 1);
  while ( *(_BYTE *)v21 );
  v2 = v21;
  v21 = (__int64 *)((char *)v21 + 1);
  *(_BYTE *)v2 = '}';
  return v16(0i64, v4, v7, 0i64);
}
// 0: using guessed type __int64 __fastcall sub_0();

//----- (000000000000042F) ----------------------------------------------------
__int64 __fastcall sub_42F(__int64 a1, _BYTE *a2)
{
  __int64 v3; // [rsp+20h] [rbp-40h]
  __int64 v4; // [rsp+28h] [rbp-38h]
  __int64 v5; // [rsp+30h] [rbp-30h]
  _DWORD *v6; // [rsp+38h] [rbp-28h]
  unsigned int i; // [rsp+5Ch] [rbp-4h]

  v6 = (_DWORD *)(*(unsigned int *)(*(int *)(a1 + 60) + a1 + 136) + a1);
  v5 = (unsigned int)v6[7] + a1;
  v4 = (unsigned int)v6[8] + a1;
  v3 = (unsigned int)v6[9] + a1;
  for ( i = 0; i < v6[6]; ++i )
  {
    if ( !(unsigned int)sub_5BD(a2, (_BYTE *)(a1 + *(unsigned int *)(4i64 * (int)i + v4))) )
      return *(unsigned int *)(4i64 * *(unsigned __int16 *)(2i64 * (int)i + v3) + v5) + a1;
  }
  return 0i64;
}

//----- (000000000000053A) ----------------------------------------------------
_WORD *__fastcall sub_53A(_WORD *a1, _WORD *a2)
{
  _WORD *v3; // rax
  _WORD *i; // [rsp+0h] [rbp-10h]
  _WORD *v5; // [rsp+8h] [rbp-8h]

  do
  {
    v5 = a1;
    for ( i = a2; ((*v5 ^ *i) & 0xFFDF) == 0 && *i; ++i )
      ++v5;
    if ( !*i )
      return a1;
    v3 = a1++;
  }
  while ( *v3 );
  return 0i64;
}

//----- (00000000000005BD) ----------------------------------------------------
__int64 __fastcall sub_5BD(_BYTE *a1, _BYTE *a2)
{
  while ( *a1 && *a1 == *a2 )
  {
    ++a1;
    ++a2;
  }
  return (unsigned __int8)*a1 - (unsigned int)(unsigned __int8)*a2;
}

//----- (000000000000060F) ----------------------------------------------------
__int64 __fastcall sub_60F(_WORD *a1)
{
  _QWORD **v2; // [rsp+40h] [rbp-20h]
  _QWORD *i; // [rsp+58h] [rbp-8h]

  v2 = (_QWORD **)(*(_QWORD *)(__readgsqword(0x60u) + 24) + 32i64);
  for ( i = *v2; i != v2; i = (_QWORD *)*i )
  {
    if ( sub_53A((_WORD *)i[8], a1) )
      return i[4];
  }
  return 0i64;
}

//----- (00000000000006A9) ----------------------------------------------------
__int64 __fastcall sub_6A9(__int64 a1, __int64 a2)
{
  char v3[7]; // [rsp+44h] [rbp-5Ch] BYREF
  char v4[21]; // [rsp+4Bh] [rbp-55h] BYREF
  _QWORD v5[2]; // [rsp+60h] [rbp-40h] BYREF
  __int16 v6; // [rsp+70h] [rbp-30h]
  __int64 v7; // [rsp+80h] [rbp-20h]
  __int64 (__fastcall *v8)(__int64, __int64, __int64, char *, _QWORD); // [rsp+88h] [rbp-18h]
  __int64 (__fastcall *v9)(__int64, __int64, __int64, _QWORD, int, _DWORD, _DWORD); // [rsp+90h] [rbp-10h]
  __int64 v10; // [rsp+98h] [rbp-8h]

  v5[0] = 'n\0r\0e\0k';
  v5[1] = '2\03\0l\0e';
  v6 = 0;
  strcpy(&v4[9], "CreateFileA");
  strcpy(v4, "ReadFile");
  v10 = sub_60F(v5);
  v9 = (__int64 (__fastcall *)(__int64, __int64, __int64, _QWORD, int, _DWORD, _DWORD))sub_42F(v10, &v4[9]);
  v8 = (__int64 (__fastcall *)(__int64, __int64, __int64, char *, _QWORD))sub_42F(v10, v4);
  v7 = v9(a1, 0x80000000i64, 1i64, 0i64, 3, 0, 0);
  return v8(v7, a2, 1000i64, v3, 0i64);
}
// 6A9: using guessed type char var_5C[7];

//----- (00000000000007AA) ----------------------------------------------------
_BOOL8 __fastcall sub_7AA(_BYTE *wallet)
{
  char v2[10]; // [rsp+1h] [rbp-Fh] BYREF
  unsigned int v3; // [rsp+Ch] [rbp-4h]

  strcpy(v2, "xk7k~>u7KZ^");
  BYTE1(v3) = 0;
  HIWORD(v3) = 0;
  while ( v3 <= 0xA )
  {
    if ( (char)wallet[v3] + 10 != v2[v3] )
      return 0i64;
    ++v3;
  }
  return wallet[11] == 0;
}

// nfuncs=7 queued=7 decompiled=7 lumina nreq=0 worse=0 better=0
// ALL OK, 7 function(s) have been successfully decompiled
